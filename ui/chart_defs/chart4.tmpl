<h2>{{.Order}}.  {{.Title}}</h2>
<p>{{.Preamble}}</p>
<div class="container">
	{{range .Charts}}
	<div class="item">
	<div class="span-title">
	<span class="span-title">{{.Person}}</span>
	</div>
	<div id="{{.DivID}}-wrap" class="lazy-chart" style="position:relative; width:600px; height:280px;">
	<canvas id="{{.DivID}}"></canvas>
	</div>
	<ul>
		<li>Total crosswords: {{.TotalAll}} (cryptic: {{.TotalCryptic}}, prize: {{.TotalPrize}})</li>
		<li>First crossword: {{.FirstDate}}</li>
		<li>Last  crossword: {{.LastDate}}</li>
		<li>Active for:      {{.Duration}}</li>
		<li>Number of clues self-referenced (with {{.Person}} in the clue): {{.SelfRef}}</li>
	</ul> 
	</div>
	{{end}}
</div>
<br />
<hr />
<script>
document.addEventListener('DOMContentLoaded', function() {
	var _chart4Defs = {};
	{{range .Charts}}
	_chart4Defs["{{.DivID}}"] = {{.ChartDef}};
	{{end}}

	(function() {
		var observer = new IntersectionObserver(function(entries) {
			entries.forEach(function(entry) {
				if (!entry.isIntersecting) return;
				var wrap = entry.target;
				var divID = wrap.id.replace('-wrap', '');
				var def = _chart4Defs[divID];
				if (def) {
					var ctx = document.getElementById(divID).getContext('2d');
					new Chart(ctx, def);
				}
				observer.unobserve(wrap);
			});
		}, { rootMargin: '200px' });

		document.querySelectorAll('.lazy-chart').forEach(function(el) {
			observer.observe(el);
		});
	})();
}); // DOMContentLoaded
</script>

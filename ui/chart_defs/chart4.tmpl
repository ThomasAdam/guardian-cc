<h2>{{.Order}}.  {{.Title}}</h2>
<p>{{.Preamble}}</p>
<div class="container">
	{{range .Charts}}
	<div class="item">
	<div class="span-title">
	<span class="span-title">{{.Person}}</span>
	</div>
	<div id="{{.DivID}}" class="lazy-chart"></div>
	<ul>
		<li>Total crosswords: {{.TotalAll}} (cryptic: {{.TotalCryptic}}, prize: {{.TotalPrize}})</li>
		<li>First crossword: {{.FirstDate}}</li>
		<li>Last  crossword: {{.LastDate}}</li>
		<li>Active for:      {{.Duration}}</li>
		<li>Number of clues self-referenced (with {{.Person}} in the clue): {{.SelfRef}}</li>
	</ul> 
	</div>
	{{end}}
</div>
<br />
<hr />
<script>
document.addEventListener('DOMContentLoaded', function() {
	var _chart4Defs = {};
	{{range .Charts}}
	_chart4Defs["{{.DivID}}"] = {{.ChartDef}};
	{{end}}

	(function() {
		var observer = new IntersectionObserver(function(entries) {
			entries.forEach(function(entry) {
				if (!entry.isIntersecting) return;
				var el = entry.target;
				var def = _chart4Defs[el.id];
				if (def) {
					def.bindto = '#' + el.id;
					c3.generate(def);
				}
				observer.unobserve(el);
			});
		}, { rootMargin: '200px' });

		document.querySelectorAll('.lazy-chart').forEach(function(el) {
			observer.observe(el);
		});
	})();
}); // DOMContentLoaded
</script>
